# Трюк, которого не было - 2

Привет, Хабр! Моя [прошлая статья]() была встречена сообществом очень хорошо. В обсуждение зашел даже @kompass_3D, чем я
по-настоящему горжусь. Я решил написать небольшое продолжение.

Основной проблемой, поднимаемой в комментариях была полная бесполезность построенного 
мной объекта. Люди искренно пытались помочь, предлагали различные варианты... Но все тщетно. Результатом всех 
дискуссий стала абсолютная ясность в полной практической бесполезности предложенных построений.

На этот раз я попробую реабилитироваться и построить что-то более пригодное. Хотя, если честно, здесь
тоже большие сомнения. Все, кому я это показывал, сначала долго смотрели в экран, потом долго смотрели на
меня, потом крутили пальцем у виска.

***

## Сейф-пряжка на ремень

Однажды я ехал в поезде, полном народу с довольно большой суммой наличных денег. Ночью хотелось поспать,
но сердце было не на месте - вдруг с деньгами что-то случится. Результатом этой бессонной ночи и стала
эта странная конструкция.

Это металлический объект, напоминающий по формы пряжку. Он сделан путем гнутья из не очень толстой стали.
Размеры позволяют запихнуть в него кредитные карты, сложенные купюры, возможно сим-карты, и прочие мелкие, но важные 
вещи. К данному изделию прилагается плоская крышка. Она вставляется в пазы,  
попадает в выемки и защелкивается за счет естественной упругости. Когда сквозь проушины в эту конструкцию вдевается 
ремень, проникнуть внутрь защищаемого объема не представляется никакой возможности (разумеется, если каким-то образом
не повредить и не ослабить ремень). Конструкция скруглена по форме тела, кроме того обладает некоторой свободой - может
подстраиваться для наилучшего сидения на теле и на ремне. Если предполагается проходить сквозь болота, пустыни, пыльную
местность - защищаемые вещи могут быть упакованы в герметичный мешочек. На передней стороне может быть нанесена
некоторая гравировка, которая может перенести статус этого изделия в разряд мужских сувениров. Возможно эта вещь 
может понравиться различным неформалам, байкерам, музыкантам, путешественникам.

Вот наверное и все что можно сказать по функционалу объекта, и теперь можно перейти непосредственно к 
геометрическим построениям.

## Преимущества параметрического построения

Если объект из предыдущей статьи я вообще не представлял, как можно построить без программирования (с учетом
предполагаемой анимации), то данный объект вполне мог быть построен традиционным конструкторскими инструментами.
Но я конечно все-равно выбрал параметрическое построение в OpenScad.
- В основном, конечно, потому что мне это нравится (как вы уже поняли я от всего этого тащусь)
- Мне еще не до конца была ясна форма и размеры - ремни бывают разной ширины, оптимальная толщина должна с одной
  стороны обеспечивать нужный защищаемый объем, с другой стороны изделие не должно слишком выделятся и мешать, 
  ну и хотелось вообще подобрать благоприятные глазу форму и пропорции
- Стало очевидно, что чертить придется две формы - объект в разогнутом виде (развертка), чтобы изготовит прототип,  
  и в полностью согнутом, чтобы проверить замыкание размеров
- Вследствие этого возникла идея - если ввести параметр согнутость от 0 до 1, то можно практически бесплатно получить
  и промежуточные состояния объекта и анимацию

Дальше я примерно опишу логику построений, и в русле общего названия статей буду называть это трюками, хотя конечно
это больше обычные решения, принимаемые при генерации различных геометрических форм.

## Трюк 1. Базовая трапеция

Примерно оценив геометрию, я понял, что всю конструкцию можно представить в виде сочетания трапеций, поэтому
практически сразу написал код генерирующий трапецию с необходимыми параметрами. Все остальное, что теперь придется 
делать - строить эти трапеции и нужным образом соединять. Это был неочевидный шаг, и в дальнейшем
он привел к некоторому эффекту, о котором я в последствии расскажу. Если отойти немного в философию программирования - 
когда вы выделяете некоторый объект - как прародитель всех остальных объектов - будьте готовы к различным
сюрпризам - как к приятным, так и не очень.

## Трюк 2. Симметрия

Еще одним очевидным свойством данного объекта является симметрия, как горизонтальная, так и вертикальная. Поэтому
мы смело можем строить только четверть объекта, а все остальное получить отражением. Этот вид мухлежа широко 
распространен в мире САПР. Если бы портной делал только четверть костюма и пытался его продать как целый - его
бы конечно посадили в тюрьму на длительный срок. А у компьютерных проектировщиков это проходит на ура.

## Трюк 3. Обратная логика построений

Это решение неочевидно и идет в разрез с интуицией. Логично начинать строить с центральных элементов и заканчивать
краевыми. Но когда я так стал делать, пытаясь учесть сгибы - оказалось, что это все порождает очень большой
объем кода - и чем дальше отходишь от центральной базы - тем хуже. Когда поступаешь наоборот - вычисления становятся 
более естественными.











